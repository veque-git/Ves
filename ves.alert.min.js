!function(){var e=ves,t=[];e.alert=function(n,l,o,a){void 0!=n&&null!=n||(n+="");var s={};t.push(s),n.content||(n={content:n}),1==t.length&&e.html.addClass("ves-alert");var c=document.createElement("div");c.id="alert",c.className="ves",c.style.zIndex="1000"+t.length;var r=document.createElement("div");r.className="body",c.appendChild(r);var i=document.createElement("div");i.className="content",r.appendChild(i),n.button=n.button||e.alert.button,s.holder=e(c),s.content=e(i),l&&("function"==typeof l?n.close=l:"string"==typeof l&&(n.type=l),"function"==typeof o?n.close?n.closed=o:(n.close=o,void 0!==a&&(n.closed=a)):"string"==typeof o?n.type=o:null===o&&(n.closed=a)),"load"==n.type&&(n.type="wait",n.style="load");var d=null;if("notify"!=n.type&&"wait"!=n.type){var p=document.createElement("div");p.className="input";var u;"confirm"==n.type&&(c.className="ves confirm",(u=document.createElement("input")).type="button",u.value=n.button.no,u.className="button no",u.name="ves_alert_button_no",e(u).bind("tap",function(){e.alert.close(!1)}),p.appendChild(u)),(d=document.createElement("input")).type="button",d.value=n.button.yes,d.className="button yes",d.name="ves_alert_button_yes",e(d).bind("tap",function(){e.alert.close(!0)}),p.appendChild(d),r.appendChild(p);var m=document.createElement("span");m.className="close",e(m).bind("tap",function(){e.alert.close(null)}),s.holder.on("tap",function(){this.event.stopParent()}),r.appendChild(m)}else"notify"==n.type?(n.closeTime=void 0!=n.closeTime?n.closeTime:2,c.className="ves notify",s.bodyTap=function(){s.closeTimer&&(window.clearInterval(s.closeTimer),delete c.closeTimer),e.alert.close(null),s.holder.off("tap",s.bodyTap),delete s.bodyTap},s.holder.on("tap",s.bodyTap)):"wait"==n.type&&(n.closeTime=null,c.className="ves wait");if(s.targetParent=null,s.targetNext=null,e.body.append(s.holder),s.holder.addClass("top"),t.length>1&&t[t.length-2].holder.removeClass("top"),s.close=n.close,s.closed=n.closed,s.context=n.context,n.style&&s.holder.addClass(n.style),s.content.html(""),n.url&&0==e(n.content).length)e.alert("","load"),e.ajax({url:n.url,dataType:n.dataType,context:s,success:function(t){this.content.html(t),setTimeout(function(){e.alert.close(),s.holder.addClass("view")},0)}});else{var f=e(n.content);if(f.length>0)s.target=f[0],f[0].parentNode&&f[0].parentNode.parentNode&&(s.targetParent=f[0].parentNode,s.targetNext=f[0].nextSibling),s.content.append(f.$);else if("load"==n.style){var h=n.content?"<br />"+n.content:"";s.content.html('<p><span class="ic_load" style="margin:10px 0;"></span>'+h+"<p>")}else s.content.html(n.content+"");e("form",s.content).each(function(){this.onsubmit=function(){return e.alert.close(!0),!1}}),s.holder.addClass("view")}return"number"==typeof n.closeTime&&n.closeTime>=0&&((u=e(".button",s.holder)).val(n.button.yes+" ( "+n.closeTime+" )"),n.closeTime-=1,s.closeTimer=window.setInterval(function(){if(n.closeTime>0==0)return window.clearInterval(s.closeTimer),delete s.closeTimer,u.val(n.button.yes),void e.alert.close();u.val(n.button.yes+" ( "+n.closeTime+" )"),n.closeTime-=1},1e3)),s.holder[0].scrollTop=0,d&&setTimeout(function(){d.focus()},50),s},e.alert.close=function(n,l){if(0!=t.length){switch(typeof n){case"number":n>t.length-1?n=t.length-1:n<0&&(n=0);break;case"object":if(null===n){l=n,n=t.length-1;break}o=n,n=t.length-1;for(s=0;s<t.length;s++)if(t[s]===o){n=s;break}break;default:l=n,n=t.length-1}var o=t[n];if("function"!=typeof o.close||!1!==o.close.call(o.context||o.target||o.content[0],l)){o.closeTimer&&window.clearInterval(o.closeTimer);for(var a=!1,s=0;s<t.length;s++)if(t[s]===o){a=!0,t.splice(s,1);break}if(a){if(t.length>0?t[t.length-1].holder.addClass("top"):setTimeout(function(){e.html.removeClass("ves-alert")},20),"function"==typeof o.closed&&o.closed.call(o.context||o.target||o.content[0],l),o.target&&o.targetParent)o.targetNext?o.targetParent.insertBefore(o.target,o.targetNext):o.targetParent.appendChild(o.target);else{var c=o.content.children(".alert:first");1==c.length&&ves.body.append(c[0])}"function"==typeof o.bodyTap&&o.holder.off("tap",o.bodyTap),o.holder.remove()}}else void 0!=o.closeTime&&(o.closeTime=2)}},e.alert.button={no:"取消",yes:"确定"},e.alert.closeAll=function(){for(;0<t.length;)e.alert.close()}}();